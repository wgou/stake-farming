"use strict";(window.webpackChunketh_farming_vue=window.webpackChunketh_farming_vue||[]).push([[872],{26872:function(t,e,i){i.r(e),i.d(e,{default:function(){return n}});var o=i(87583),s={data:function(){return{secretKey:"",authCode:"",userName:"",butShow:!0,visible:!1}},created:function(){this.check()},methods:{init:function(){var t=this;this.visible=!0,this.$nextTick(function(){t.$refs.dataForm.resetFields()})},check:function(){var t=this;this.$http({url:this.$http.adornUrl("/googleAuth/check"),method:"get"}).then(function(e){e.data.success&&(t.butShow=!1)})},firstAuth:function(){var t=this;this.$http({url:this.$http.adornUrl("/googleAuth/firstAuth"),method:"post",data:this.$http.adornParams({secretKey:this.secretKey,authCode:this.authCode})}).then(function(e){var i=e.data;i.success?(t.$message({message:"Google 令牌绑定成功!",type:"success",duration:2500,onClose:function(){}}),t.visible=!1):t.$message.error(i.msg)})},bindFinish:function(){var t=this;this.visible=!1,this.$prompt("请输入Google 令牌","提示",{confirmButtonText:"确定",cancelButtonText:"取消"}).then(function(e){var i=e.value;i?(t.authCode=i,t.firstAuth()):t.$message.error("请输入Google 令牌")}).catch(function(){})},bind:function(){var t=this;this.visible=!0,this.$http({url:this.$http.adornUrl("/googleAuth/gen"),method:"post"}).then(function(e){var i=e.data;i.success?(t.secretKey=i.data.secretKey,o.toCanvas(t.$refs.qr,i.data.qr,{width:300,height:300,colorDark:"#000000",colorLight:"#ffffff"},function(t){t&&this.$message.error(t)})):t.$message.error(i.msg)})}}},n=(0,i(14486).A)(s,function(){var t=this,e=t._self._c;return e("el-dialog",{attrs:{title:"绑定Google令牌","close-on-click-modal":!1,visible:t.visible,"append-to-body":!0,width:"400px"},on:{"update:visible":function(e){t.visible=e}}},[e("el-form",{ref:"dataForm",attrs:{"label-position":"right"}},[e("canvas",{ref:"qr",staticStyle:{width:"300px",margin:"30px"}}),e("el-alert",{attrs:{title:"1.请在各大应用商店下载[Google Authenticator]并安装",type:"info",closable:!1}}),e("el-alert",{staticStyle:{"margin-top":"5px"},attrs:{title:"2.使用[Google Authenticator]扫上面二维码,后点击绑定完成",type:"info",closable:!1}})],1),e("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[e("el-button",{on:{click:function(e){t.visible=!1}}},[t._v("关闭窗口")]),t.butShow?e("el-button",{attrs:{type:"primary"},on:{click:t.bindFinish}},[t._v("确定绑定")]):t._e()],1)],1)},[],!1,null,null,null).exports}}]);